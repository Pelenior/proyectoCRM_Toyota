<div class="max-w-7xl mx-auto px-4 py-10">
    
    @if (isLoading()) {
        <div class="flex justify-center items-center h-40">
            <p class="text-gray-500 text-lg">Cargando datos...</p>
        </div>
    } @else {

        @if (userRole() === 'ADMIN' || userRole() === 'ROLE_ADMIN') {
            <h2 class="text-2xl font-bold text-gray-800 mb-6 border-b pb-2">
                Directorio de Choferes y Asignaciones
            </h2>

            <div class="bg-white p-6 rounded-lg shadow-md">
                <div class="relative overflow-x-auto">
                    <table class="w-full text-sm text-left text-gray-500">
                        <thead class="text-xs text-gray-700 uppercase bg-emerald-50">
                            <tr>
                                <th class="px-6 py-3">ID</th>
                                <th class="px-6 py-3">Chofer</th>
                                <th class="px-6 py-3">Clientes Asignados</th>
                                <th class="px-6 py-3">Teléfono</th>
                            </tr>
                        </thead>
                        <tbody>
                            @for (chofer of listaChoferes(); track chofer.id) {
                                <tr class="bg-white border-b hover:bg-gray-50">
                                    <td class="px-6 py-4 font-medium">{{ chofer.id }}</td>
                                    <td class="px-6 py-4 font-bold text-gray-900">{{ chofer.nombre }}</td>
                                    
                                    <td class="px-6 py-4">
                                        <div class="flex flex-wrap gap-2">
                                            @for (cliente of getClientesDeChofer(chofer.id); track cliente.id) {
                                                <span class="bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded border border-blue-400">
                                                    {{ cliente.nombre }}
                                                </span>
                                            } @empty {
                                                <span class="text-gray-400 italic text-xs">Sin asignaciones</span>
                                            }
                                        </div>
                                    </td>

                                    <td class="px-6 py-4">{{ chofer.telefono }}</td>
                                </tr>
                            } @empty {
                                <tr><td colspan="4" class="px-6 py-4 text-center">No hay choferes registrados.</td></tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        } 
        
        @else {
            <h2 class="text-2xl font-bold text-gray-800 mb-6 border-b pb-2">
                Mis Clientes
            </h2>

            <div class="bg-white p-6 rounded-lg shadow-md">
                <div class="relative overflow-x-auto">
                    <table class="w-full text-sm text-left text-gray-500">
                        <thead class="text-xs text-gray-700 uppercase bg-indigo-50">
                            <tr>
                                <th class="px-6 py-3">Nombre del Cliente</th>
                                <th class="px-6 py-3">Contacto Email</th>
                                <th class="px-6 py-3">Teléfono</th>
                                <th class="px-6 py-3">Estado</th>
                            </tr>
                        </thead>
                        <tbody>
                            @for (cliente of misClientes(); track cliente.id) {
                                <tr class="bg-white border-b hover:bg-gray-50">
                                    <td class="px-6 py-4 font-bold text-gray-900">{{ cliente.nombre }}</td>
                                    <td class="px-6 py-4">{{ cliente.email }}</td>
                                    <td class="px-6 py-4">{{ cliente.telefono }}</td>
                                    <td class="px-6 py-4">
                                        <span class="bg-green-100 text-green-800 text-xs font-medium px-2.5 py-0.5 rounded">
                                            Confirmado
                                        </span>
                                    </td>
                                </tr>
                            } @empty {
                                <tr>
                                    <td colspan="4" class="px-6 py-12 text-center">
                                        <p class="text-gray-500">No tienes viajes asignados actualmente.</p>
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        }

    }
</div>